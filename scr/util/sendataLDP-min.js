let diff=0,Is_device_motion_change=null,Count_device_motion=0,device_motion_compare=0,Skl_vistorID=null,Detect_bot=!1,bodyVisitorID={},frames=[],paramsVisitorID={url:window.location.href,components:{},organization_id:"651bc916e99ffcef40ae6436",browser_vid:null,is_bot:!1};function appendIframeVertical(){const e=document.querySelectorAll(".skycom-wrapper");e.length>0&&e.forEach((function(e){if(!e)return;const t=document.createElement("iframe");t.src="https://testform.skycom.vn/v5",t.classList.add("skycom-iframe"),e.insertBefore(t,e.children[0])}))}function checkDeviceEmotion(){window.DeviceMotionEvent&&(window.addEventListener("devicemotion",(function(e){diff=e.acceleration.x||e.accelerationIncludingGravity.x,handleDeviceMotionStatus()})),setInterval((()=>{diff!=device_motion_compare&&(Count_device_motion++,device_motion_compare=diff)}),1e3))}function handleDeviceMotionStatus(){Is_device_motion_change=Count_device_motion>5}function listenFirame(){document.querySelectorAll(".skycom-iframe").forEach((function(e){frames.push(e),e.addEventListener("load",(function(){sendMessage(e)}))}))}function sendMessage(e){const t=JSON.stringify({message:"send data",src:window.location.href,Is_device_motion_change:Is_device_motion_change,Count_device_motion:Count_device_motion,bodyVisitorID:paramsVisitorID,Skl_vistorID:paramsVisitorID.browser_vid,Detect_bot:paramsVisitorID.is_bot});e.contentWindow.postMessage({call:"skylink_event",value:t},"https://testform.skycom.vn/")}const getComponentsFingerVisitorId=()=>{FingerprintJS.load().then((e=>e.get())).then((function(e){paramsVisitorID.components=e.components})).then((e=>{detectBot()})).then((e=>{handlePostDataVistor()})).catch((e=>{}))},detectBot=()=>{import("https://testform.skycom.vn/util/fingerdetectbot.min.js").then((e=>e.load())).then((e=>e.detect())).then((e=>{paramsVisitorID.is_bot=e.bot})).catch((e=>{}))},handlePostDataVistor=()=>{fetch("https://fingerprint.skycom.vn/api/v1/visits/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(paramsVisitorID)}).then((function(e){return e.json()})).then((function(e){let t=e.data;return document.cookie=`browser_vid=${t.visitor_id}`,localStorage.setItem("browser_vid",t.visitor_id),paramsVisitorID.browser_vid=t.visitor_id,t})).catch((e=>{}))},browserVisitorid=()=>{localforage.getItem("browser_vid").then((e=>{if(e)paramsVisitorID.browser_vid=e;else if(localStorage.getItem("browser_vid"))paramsVisitorID.browser_vid=localStorage.getItem("browser_vid");else{const e=new RegExp("(^| )browser_vid=([^;]+)"),t=document.cookie.match(e);t&&(paramsVisitorID.browser_vid=t[2])}}))};document.addEventListener("DOMContentLoaded",(function(){appendIframeVertical(),checkDeviceEmotion(),localforage.getItem("browser_vid").then((e=>{if(e)paramsVisitorID.browser_vid=e;else if(localStorage.getItem("browser_vid"))paramsVisitorID.browser_vid=localStorage.getItem("browser_vid");else{const e=new RegExp("(^| )browser_vid=([^;]+)"),t=document.cookie.match(e);t&&(paramsVisitorID.browser_vid=t[2])}})),FingerprintJS.load().then((e=>e.get())).then((function(e){paramsVisitorID.components=e.components})).then((e=>{detectBot()})).then((e=>{handlePostDataVistor()})).catch((e=>{})),listenFirame()}));