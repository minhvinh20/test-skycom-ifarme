let encodeName="",encodePhone="";const regexPhone=/^(0|\+84)(9[0-9]|3[2-9]|7[06-9]|5[6-9]|8[1-9]|2[0-9])\d{7}$/;let parentUrl=window.location.href.indexOf("split=")>-1?window.location.href.split("split=")[1]:document.location.href;const bareURL="https://backendsyncdata.skycom.vn/api/spam_check/form-spam-check",urlThankReal="https://hoaianbeauty.com/pages/cam-on-quy-khach",urlThankFake="https://hoaianbeauty.com/pages/camon-quy-khach",urlSyncGoogleSheetSpam="https://script.google.com/macros/s/AKfycbzGbJQ83uGDjEGC5x8yqbIjKr0ATrzk6gNYcIxAI958cHpSfc-r6KHnylZNK7fxCpFgaQ/exec",inputCache=document.querySelectorAll(".input-cache input"),form=document.getElementById("form1");function getRandomInt(e){return Math.floor(Math.random()*e)}const number=getRandomInt(100);function textEnpty(e){return" ".repeat(e)}const encryptionIDFileds=()=>{inputCache.forEach(((e,t)=>{const n=(Math.random()+1).toString(36).slice(2,7);0===t&&(encodeName=n),1===t&&(encodePhone=n);let o=e.getAttribute("placeholder");o+=textEnpty(100)+n+"-"+n+textEnpty(getRandomInt(20))+n+"-"+n,e.setAttribute("id",n),e.setAttribute("name",n),e.setAttribute("placeholder",o)}))};inputCache.forEach(((e,t)=>{const n=(Math.random()+1).toString(36).slice(2,7);0===t&&(encodeName=n),1===t&&(encodePhone=n);let o=e.getAttribute("placeholder");o+=textEnpty(100)+n+"-"+n+textEnpty(getRandomInt(20))+n+"-"+n,e.setAttribute("id",n),e.setAttribute("name",n),e.setAttribute("placeholder",o)}));const syncToSheetServerFail=async({name:e,phone:t,link:n,reasons:o})=>{await fetch(`${urlSyncGoogleSheetSpam}?name=${e}&phone=${t}&link=${n.replaceAll("&","_SKYCOM_")}&reason=${o}&SHEET_NAME=ErrorServer`,{method:"GET",mode:"no-cors",headers:{"Content-Type":"application/json"},redirect:"follow"})},syncToSheetDataSubmit=async({name:e,phone:t,link:n,spam:o,reasons:a})=>{await fetch(`${urlSyncGoogleSheetSpam}?name=${e}&phone=${t}&link=${n.replaceAll("&","_SKYCOM_")}&spam=${o}&reasons=${a}&SHEET_NAME=TotalSDT`,{method:"GET",mode:"no-cors",headers:{"Content-Type":"application/json"},redirect:"follow"})},validateForm=()=>{const e=document.getElementById(`${encodePhone}`).value;let t=!0;return regexPhone.test(e)||(document.getElementById("errorMessage").innerText="Vui lòng nhập đúng định dạng số điện thoại",t=!1),t},handlePostData=async({Ten1:e,Ten2:t,name:n,phone:o,time:a})=>{const r={Ten1:e,Ten2:t,name:n,phone:o,link:parentUrl,actionTime:a};await fetch(bareURL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((e=>e.json())).then((n=>{syncToSheetDataSubmit({name:e,phone:t,link:parentUrl,spam:n.spam,reasons:n.reasons}),n.spam?window.parent.location.replace(urlThankFake):window.parent.location.replace(urlThankReal)})).catch((n=>{syncToSheetServerFail({name:e,phone:t,link:parentUrl,reason:n.message})}))},handleSubmit=()=>{const e=new Date;form.addEventListener("submit",(t=>{t.preventDefault();if(validateForm()){const t=Math.round(Math.abs(new Date-e)/1e3),n=document.getElementById(`${encodeName}`).value,o=document.getElementById(`${encodePhone}`).value,a=document.getElementById("ten2").value,r=document.getElementById("sdt2").value,c=document.getElementById("btn-submit");c.innerText="ĐANG XỬ LÝ!!!",c.parentElement.classList.add("disable"),handlePostData({Ten1:n,Ten2:o,name:a,phone:r,time:t})}}))};grecaptcha.ready((function(){grecaptcha.execute("6Lf5K9MnAAAAAACAkPZK5G-N5iHEOLI25oMPjOH8",{action:"submit"}).then((function(e){handleSubmit()}))}));const randomPositionFields=()=>{const e=document.querySelectorAll(".form-control"),t=document.getElementById(encodeName).parentElement.innerHTML,n=document.getElementById(encodePhone).parentElement.innerHTML;number%2==0?(e[0].innerHTML=t,e[1].innerHTML=n):(e[0].innerHTML=n,e[1].innerHTML=t)};randomPositionFields();const disableCopy=()=>{document.getElementById(encodeName).onpaste=e=>e.preventDefault(),document.getElementById(encodePhone).onpaste=e=>e.preventDefault()};document.getElementById(encodeName).onpaste=e=>e.preventDefault(),document.getElementById(encodePhone).onpaste=e=>e.preventDefault();const disableEnterSubmit=()=>{document.addEventListener("keydown",(e=>{13!==e.keyCode||e.preventDefault()}))};document.addEventListener("keydown",(e=>{13!==e.keyCode||e.preventDefault()}));const syncToSheetValidate=async({phone:e,link:t})=>{await fetch(`${urlSyncGoogleSheetSpam}?phone=${e}&link=${t.replaceAll("&","_SKYCOM_")}&SHEET_NAME=SDTValidate`,{method:"GET",mode:"no-cors",headers:{"Content-Type":"application/json"},redirect:"follow"})},listenEventChangeFielsValidate=()=>{document.getElementById(encodePhone).addEventListener("input",(e=>{regexPhone.test(e.target.value)&&syncToSheetValidate({phone:e.target.value,link:parentUrl})}))};document.getElementById(encodePhone).addEventListener("input",(e=>{regexPhone.test(e.target.value)&&syncToSheetValidate({phone:e.target.value,link:parentUrl})}));